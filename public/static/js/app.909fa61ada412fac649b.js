webpackJsonp([1],{NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("7+uW"),s=i("zL8q"),r=i.n(s),n=(i("tvR6"),{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view",{attrs:{name:"nav"}}),this._v(" "),e("router-view",{attrs:{name:"content"}})],1)},staticRenderFns:[]}),o=i("VU/8")({name:"App",data:function(){return{}}},n,!1,null,null,null).exports,l=i("/ocq"),c="获取短信验证码",d="秒后重新获取",u="您输入的手机不是管理员，请到小程序进行注册。",m={data:function(){return{tel:"",code:"",telError:!1,numError:!1,countdownRange:60,counting:!1}},computed:{codeButtonText:function(){return this.counting?""+this.countdownRange+d:""+c}},methods:{validate:function(){return/^1[34578][0-9]{9}$/.test(this.tel)},login:function(){var t=this;if(this.validate()&&6==this.code.length){var e={tel:this.tel,code:this.code};this.$http.post(this.GLOBAL.requestUrls.login,e).then(function(e){t.setCookie("token",e.headers.authorization,t.GLOBAL.expire),t.setCookie("name",e.data.name),t.$router.push(t.GLOBAL.routers.projects)}).catch(function(e){422===e.response.status&&(t.numError=!0)})}else this.validate()&&6==!this.code.length?this.numError=!0:this.validate()||6!=this.code.length?(this.telError=!0,this.numError=!0):this.telError=!0},countdown:function(){this.counting=!0,this._count()},getCode:function(){var t=this;if(this.telError=!this.validate(),!this.telError){var e={tel:this.tel};this.$http.post(this.GLOBAL.requestUrls.code,e).then(function(e){t.countdown()}).catch(function(e){422===e.response.status&&(t.telError=!0),403===e.response.status&&t.$message.error(u)})}},_count:function(){if(0===this.countdownRange)return this.counting=!1,void(this.countdownRange=60);this.countdownRange--,setTimeout(this._count,1e3)}}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"login-com-container",staticStyle:{"background-image":"url('./static/images/login.jpg')"}},[i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"login-title"},[i("span",{staticClass:"title-zn"},[t._v("预约管理系统")]),t._v(" "),i("span",{staticClass:"title-en"},[t._v("Reservation Management System")])]),t._v(" "),i("div",{staticClass:"login-content"},[i("div",{staticClass:"input-container"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.tel,expression:"tel"}],staticClass:"login-input",attrs:{type:"text",placeholder:"请输入手机号码",maxlength:"11"},domProps:{value:t.tel},on:{input:function(e){e.target.composing||(t.tel=e.target.value)}}}),t._v(" "),i("div",{staticClass:"error-msg tel-error"},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.telError,expression:"telError"}]},[t._v("请输入正确的手机号")])])]),t._v(" "),i("div",{staticClass:"input-wrapper"},[i("div",{staticClass:"input-msg-container"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"login-input message-input",attrs:{type:"number",placeholder:"请输入6位短信验证码"},domProps:{value:t.code},on:{input:function(e){e.target.composing||(t.code=e.target.value)}}})]),t._v(" "),i("el-button",{attrs:{type:"text",disabled:t.counting},on:{click:t.getCode}},[t._v("\n          "+t._s(t.codeButtonText)+"\n        ")]),t._v(" "),i("div",{staticClass:"error-msg code-error"},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.numError,expression:"numError"}]},[t._v("请输入正确的短信验证码")])])],1),t._v(" "),i("el-button",{staticClass:"login-btn",attrs:{type:"primary",disabled:""==t.tel||""==t.code},on:{click:t.login}},[t._v("\n        登录\n      ")])],1)])],1)},staticRenderFns:[]},h=i("VU/8")(m,p,!1,null,null,null).exports,v={props:{originUrl:{type:String,default:""},className:{type:String,default:""},imageWrapper:{type:String,default:""}},data:function(){return{imgClass:this.className,imgWrapperClass:this.imageWrapper}},computed:{fomatedUrl:function(){if(this.originUrl)return this.GLOBAL.server+this.originUrl}},methods:{handleOnload:function(){this.$emit("onLoad")}}},f={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{class:this.imgWrapperClass},[e("img",{class:this.imgClass,attrs:{src:this.fomatedUrl},on:{load:this.handleOnload}})])},staticRenderFns:[]},_=i("VU/8")(v,f,!1,null,null,null).exports,g={components:{"formated-image":_},props:{project:{type:Object,default:""}},data:function(){return{imageClass:"project-image",codeClass:"code"}},methods:{handleStopPropagation:function(t){t.stopPropagation()},editProject:function(){this.$router.push(this.GLOBAL.routers.projects_edit+this.project.id)},showDetail:function(){this.$router.push(this.GLOBAL.routers.reservations_details+this.project.id+"/"+this.project.name)}}},C={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{on:{click:t.showDetail}},[i("formated-image",{staticClass:"image-wrapper",attrs:{originUrl:t.project.image,className:t.imageClass}}),t._v(" "),i("span",{staticClass:"project-name"},[t._v(t._s(t.project.name))]),t._v(" "),"open"===t.project.state?i("span",{staticClass:"project-state"},[t._v("开启")]):i("span",{staticClass:"project-state"},[t._v("关闭")]),t._v(" "),i("span",{staticClass:"project-share",on:{click:function(e){return e.stopPropagation(),t.handleStopPropagation(e)}}},[i("i",{staticClass:"el-icon-edit oprerate-icon",on:{click:function(e){return e.stopPropagation(),t.editProject(e)}}}),t._v(" "),i("el-dropdown",{attrs:{trigger:"click"}},[i("span",{staticClass:"el-dropdown-link"},[i("i",{staticClass:"el-icon-share oprerate-icon"})]),t._v(" "),i("el-dropdown-menu",{staticClass:"dropdown-container",attrs:{slot:"dropdown"},slot:"dropdown"},[i("div",{staticClass:"text"},[i("span",{staticClass:"icon",staticStyle:{"background-image":"url('./static/images/wechat.png')"}}),t._v(" "),i("span",[t._v("微信扫一扫")])]),t._v(" "),i("formated-image",{staticClass:"code-wrapper",attrs:{originUrl:t.project.wxcode,className:t.codeClass}})],1)],1)],1)],1)},staticRenderFns:[]},k={components:{"project-entrance":i("VU/8")(g,C,!1,null,null,null).exports},data:function(){return{activeName:"project",projectsList:[]}},methods:{handleClick:function(t,e){console.log(t,e)},newProject:function(){this.$router.push(this.GLOBAL.routers.projects_new)}},mounted:function(){var t=this;this.$http.get(this.GLOBAL.requestUrls.projects,this.getRequestConfig()).then(function(e){t.projectsList=e.data.projects,t.setCookie("token",e.headers.authorization,t.GLOBAL.expire)}).catch(function(e){t.handleHttpError(e)})}},b={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"admin-com-container"},[i("div",{staticClass:"tabs-wrapper"},[i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"预约项目",name:"project"}},[i("div",{staticClass:"card-wrapper"},[i("div",{staticClass:"card-item add-card",on:{click:t.newProject}},[i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"card-content"},[i("div",{staticClass:"card-icon"},[i("i",{staticClass:"el-icon-circle-plus"})]),t._v(" "),i("p",[t._v("创建新的预约项目")])])])],1),t._v(" "),t._l(t.projectsList,function(t){return i("div",{staticClass:"card-item project"},[i("project-entrance",{attrs:{project:t}})],1)})],2)]),t._v(" "),i("el-tab-pane",{attrs:{label:"分类",name:"category"}})],1)],1)])},staticRenderFns:[]},w=i("VU/8")(k,b,!1,null,null,null).exports,L={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"nav-com-container"},[i("span",{staticClass:"nav-title"},[t._v("预约系统")]),t._v(" "),i("div",{staticClass:"drop-wrapper"},[i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("span",{staticClass:"el-dropdown-link nick-name"},[t._v("\n        "+t._s(t.nickName)+"\n        "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[t._v("修改个人消息")]),t._v(" "),i("el-dropdown-item",[t._v("查看回收站")]),t._v(" "),i("el-dropdown-item",[t._v("我的邀请")]),t._v(" "),i("el-dropdown-item",{attrs:{command:"logout"}},[t._v("退出")])],1)],1)],1)])},staticRenderFns:[]},y=i("VU/8")({data:function(){return{nickName:"管理员"}},created:function(){this.nickName=this.getCookie("name")},methods:{handleCommand:function(t){"logout"===t&&this.logout()},logout:function(){this.delCookie("token"),this.$router.push(this.GLOBAL.routers.login)}}},L,!1,null,null,null).exports,S=i("mvHQ"),T=i.n(S),x=i("gRE1"),j=i.n(x),$=i("fZjL"),V=i.n($),D={components:{"formated-image":_},props:{image:{type:String,default:""}},data:function(){return{coverModalVisible:!1,currentImage:this.image,defaultImageList:[],classNames:{form_cover:"form-cover",default_cover:"img",image_wrapper:"item-img-wrapper",cover_wrapper:"cover-wrapper"}}},created:function(){this.getCovers()},methods:{getCovers:function(){var t=this;this.$http.get(this.GLOBAL.requestUrls.covers).then(function(e){t.defaultImageList=e.data.images,""===t.currentImage&&(t.currentImage=t.defaultImageList[0])})},handleImageOnload:function(t){this.loading&&this.loading.close()},handleUpload:function(){var t=this;this.loading=this.$loading({target:".img-wrapper",background:"#f1f1f1"}),lrz(this.$refs.uploadImageRef.files[0]).then(function(e){var i=new FormData;i.append("image",e.formData.get("file")),t.$http.post(t.GLOBAL.requestUrls.image,i,t.getRequestConfig()).then(function(e){t.currentImage=e.data.image,t.setCookie("token",e.headers.authorization,t.GLOBAL.expire)}).catch(function(e){t.handleHttpError(e)})}),this.coverModalVisible=!1},changeCover:function(t){this.currentImage=this.defaultImageList[t],this.coverModalVisible=!1},updateValue:function(t){this.currentImage=t},getData:function(){return this.currentImage}}},A={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"img-wrapper"},[i("formated-image",{attrs:{originUrl:t.currentImage,className:t.classNames.form_cover,imageWrapper:t.classNames.cover_wrapper},on:{onLoad:t.handleImageOnload}}),t._v(" "),i("div",{staticClass:"change-cover-btn"},[i("el-button",{staticClass:"change-cover",attrs:{type:"primary"},on:{click:function(e){t.coverModalVisible=!0}}},[t._v("更换封面")]),t._v(" "),i("el-dialog",{attrs:{title:"更换封面",visible:t.coverModalVisible,width:"858px",center:""},on:{"update:visible":function(e){t.coverModalVisible=e}}},[i("div",{staticClass:"imgs-list"},[i("div",{staticClass:"upload imgs-item"},[i("label",{attrs:{for:"file_input"}},[i("i",{staticClass:"el-icon-upload"}),t._v(" "),i("div",[t._v("上传图片")])]),t._v(" "),i("input",{ref:"uploadImageRef",attrs:{type:"file",id:"file_input",accept:"image/*"},on:{change:t.handleUpload}})]),t._v(" "),t._l(t.defaultImageList,function(e,a){return i("div",{staticClass:"imgs-item",on:{click:function(e){t.changeCover(a)}}},[i("formated-image",{attrs:{originUrl:e,className:t.classNames.default_cover,imageWrapper:t.classNames.image_wrapper}})],1)})],2)])],1)],1)},staticRenderFns:[]},R=i("VU/8")(D,A,!1,null,null,null).exports,I={props:{address:{type:String,default:""},latitude:{type:Number,default:0},longitude:{type:Number,default:0}},data:function(){return{currentAddress:this.address,currentLatitude:this.latitude,currentLongitude:this.longitude,isShowMap:!1,isShowPanel:!1,isInitMap:!0,markers:[]}},methods:{handleFocus:function(){this.isShowMap=!0,this.$route.params.id&&this.isInitMap?(this.mapInit(),this.isInitMap=!1):this.currentLatitude&&this.currentLongitude&&this.currentAddress?this.renderOriginLocation():this.currentAddress||(this.mapInit(),this.currentLatitude=0,this.currentLongitude=0)},mapInit:function(){this.map=new AMap.Map("map-container",{zoom:12}),this.geocoderInit(),this.placeSearchInit(),this.infoWindowInit(),this.mapClick(),this.renderOriginLocation()},geocoderInit:function(){var t=this;AMap.plugin("AMap.Geocoder",function(){t.geocoder=new AMap.Geocoder({radius:1e3,extensions:"all"}),t.map.addControl(t.geocoder)})},placeSearchInit:function(){var t=this;AMap.service(["AMap.PlaceSearch"],function(){t.placeSearch=new AMap.PlaceSearch({pageSize:5,pageIndex:1,city:"028",map:t.map,panel:"map-panel",renderStyle:"default"})})},infoWindowInit:function(){var t=this;AMap.plugin("AMap.InfoWindow",function(){t.infoWindow=new AMap.InfoWindow({content:"",autoMove:!0,closeWhenClickMap:!0})})},renderOriginLocation:function(){if(this.currentLatitude&&this.currentLongitude&&this.currentAddress){var t=new AMap.Marker({position:[this.currentLongitude,this.currentLatitude]});t.setMap(this.map),this.map.setZoom(14),this.map.setCenter([this.currentLongitude,this.currentLatitude]),this.markers.push(t),this.renderInfoWindow(this.currentLongitude,this.currentLatitude,t)}},mapClick:function(){var t=this;this.map.on("click",function(e){var i=e.lnglat.getLng(),a=e.lnglat.getLat();t.map.remove(t.markers),t.updatePosition(i,a),t.setMarker(i,a),t.placeSearch.clear()}),this.placeSearch.on("listElementClick",function(e){t.updateValue(t.getPositionInfo(e))}),this.placeSearch.on("markerClick",function(e){t.updateValue(t.getPositionInfo(e))})},getPositionInfo:function(t){return{latitude:t.data.location.lat,longitude:t.data.location.lng,address:t.data.cityname+t.data.adname+t.data.address}},setMarker:function(t,e){var i=new AMap.Marker({position:[t,e]});i.setMap(this.map),this.map.setZoom(14),this.map.setCenter([t,e]),this.markers.push(i),this.renderInfoWindow(t,e,i)},renderInfoWindow:function(t,e,i){var a=this;this.geocoder.getAddress([t,e],function(s,r){"complete"===s&&"OK"===r.info&&(a.currentAddress=r.regeocode.formattedAddress,a.infoWindow.setContent("<div>"+r.regeocode.formattedAddress+"</div"),a.infoWindow.open(a.map,[t,e]),i.on("click",function(){a.infoWindow.open(a.map,[t,e]),a.updatePosition(t,e)}))})},search:function(){this.isShowMap&&(this.isShowPanel=!0,this.map.remove(this.markers),this.infoWindow.close(),this.placeSearch.search(this.currentAddress))},closeMap:function(){this.isShowPanel=!1,this.placeSearch.clear(),this.isShowMap=!1},updateValue:function(t){this.currentAddress=t.address,this.currentLatitude=t.latitude,this.currentLongitude=t.longitude},updatePosition:function(t,e){this.currentLatitude=e,this.currentLongitude=t},getData:function(){return{address:this.currentAddress,latitude:this.currentLatitude,longitude:this.currentLongitude}}}},O={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"form-address"},[i("span",{staticClass:"address-text"},[t._v("详细地址: ")]),t._v(" "),i("el-input",{staticClass:"address-input",on:{focus:t.handleFocus},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.currentAddress,callback:function(e){t.currentAddress=e},expression:"currentAddress"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.search},slot:"append"})],1)],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowMap,expression:"isShowMap"}],attrs:{id:"map-container"}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowPanel,expression:"isShowPanel"}],attrs:{id:"map-panel"}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowMap,expression:"isShowMap"}],staticClass:"map-close",on:{click:t.closeMap}},[i("i",{staticClass:"el-icon-close"})])])},staticRenderFns:[]},M=i("VU/8")(I,O,!1,null,null,null).exports,B={Mon:"周一",Tues:"周二",Wed:"周三",Thur:"周四",Fri:"周五",Sat:"周六",Sun:"周日",Holiday:"法定节假日"},E="请填写时间段和重复日期",N="已存在相同时间段",U="请输入正确的时间段",P=[{value:"Mon",label:"周一"},{value:"Tues",label:"周二"},{value:"Wed",label:"周三"},{value:"Thur",label:"周四"},{value:"Fri",label:"周五"},{value:"Sat",label:"周六"},{value:"Sun",label:"周日"},{value:"Holiday",label:"法定节假日"}],G={props:{timeState:{type:Object,default:{normal:[{time:"09:00-10:00",limit:10,weekday:["Mon","Tues","Wed","Thur","Fri"]}],special:[]}}},data:function(){return{weekdays:P,currentTimeState:this.timeState,settingDialogVisible:!1,isShowNormal:!0,weekdayValue:["Mon","Tues","Wed","Thur","Fri"],limitValue:"",startTime:"",endTime:"",editStatus:!1,editIndex:null}},computed:{formatedTimeState:function(){return this.currentTimeState.normal.map(function(t){var e=t.weekday.map(function(t){return B[t]});return{time:t.time,limit:t.limit,weekday:e}})}},methods:{newItem:function(){this.settingDialogVisible=!0,this.startTime="09:00",this.endTime="10:00",this.weekdayValue=["Mon","Tues","Wed","Thur","Fri"],this.limitValue=" "},validateEmpty:function(){return this.error={},this.startTime&&this.endTime&&this.weekdayValue.length||(this.error.empty_tip=E),0==V()(this.error).length},validateNewTime:function(t){var e=this;return this.error={},this.currentTimeState.normal.forEach(function(i){i.time==t&&(e.error.repeat_tip=N)}),0==V()(this.error).length},validateEditTime:function(t){var e=this;return this.error={},this.currentTimeState.normal.forEach(function(i,a){a!==e.editIndex&&i.time===t&&(e.error.repeat_tip=N)}),0==V()(this.error).length},validateTime:function(t,e){return this.error={},t>=e&&(this.error.invalid_tip=U),0==V()(this.error).length},compeleteSetting:function(){var t,e={},i=this.startTime+"-"+this.endTime,a=this.weekdayValue;t=" "===this.limitValue||""===this.limitValue?null:Math.abs(parseInt(this.limitValue)),this.validateEmpty()?(e={time:i,limit:t,weekday:a},this.validateTime(this.startTime,this.endTime)?this.editStatus?this.validateEditTime(i)?(this.currentTimeState.normal.splice(this.editIndex,1,e),this.settingDialogVisible=!1):this.$message.error(this.error.repeat_tip):this.validateNewTime(i)?(this.currentTimeState.normal.push(e),this.settingDialogVisible=!1):this.$message.error(this.error.repeat_tip):(this.settingDialogVisible=!0,this.$message.error(this.error.invalid_tip))):(this.settingDialogVisible=!0,this.$message.error(this.error.empty_tip))},deleteItem:function(t){this.currentTimeState.normal.splice(t,1)},editItem:function(t){this.settingDialogVisible=!0;var e=this.currentTimeState.normal[t];this.startTime=e.time.split("-")[0],this.endTime=e.time.split("-")[1],this.weekdayValue=e.weekday,this.limitValue=null===e.limit?" ":e.limit,this.editStatus=!0,this.editIndex=t},updateValue:function(t){this.currentTimeState=t},getData:function(){return this.currentTimeState}}},F={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form-settime-wrapper"},[i("el-radio-group",{staticClass:"setting-pattern",model:{value:t.isShowNormal,callback:function(e){t.isShowNormal=e},expression:"isShowNormal"}},[i("el-radio-button",{attrs:{label:!0}},[t._v("常规设置")]),t._v(" "),i("el-radio-button",{attrs:{label:!1}},[t._v("特殊设置")])],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowNormal,expression:"isShowNormal"}],staticClass:"normal-setting-wrapper"},[i("div",{staticClass:"normal-setting-item-wrapper"},t._l(t.formatedTimeState,function(e,a){return i("div",{staticClass:"normal-setting-item"},[i("span",{staticClass:"item-left"},[t._v(t._s(e.time))]),t._v(" "),i("div",{staticClass:"item-right"},[i("div",{staticClass:"weekday-container",on:{click:function(e){t.editItem(a)}}},t._l(e.weekday,function(e){return i("span",{staticClass:"weekday"},[t._v(t._s(e))])})),t._v(" "),null===e.limit?i("span",{staticClass:"number"},[t._v("名额不限制")]):i("span",{staticClass:"number"},[t._v("名额"+t._s(e.limit)+"人")])]),t._v(" "),i("span",{staticClass:"operate-btn"},[i("i",{staticClass:"el-icon-circle-plus-outline",on:{click:t.newItem}}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:t.formatedTimeState.length>1,expression:"formatedTimeState.length > 1"}],staticClass:"el-icon-remove-outline",on:{click:function(e){t.deleteItem(a)}}})])])})),t._v(" "),i("el-dialog",{attrs:{title:"预约时间设置",visible:t.settingDialogVisible,width:"600px",center:""},on:{"update:visible":function(e){t.settingDialogVisible=e},close:function(e){t.editStatus=!1}}},[i("div",{staticClass:"setting-content"},[i("div",{staticClass:"fields"},[i("span",{staticClass:"text"},[t._v("时间段: ")]),t._v(" "),i("el-time-picker",{attrs:{placeholder:"开始时间","value-format":"HH:mm",format:"HH:mm"},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),t._v(" "),i("span",{staticClass:"middle-text"},[t._v("至")]),t._v(" "),i("el-time-picker",{attrs:{placeholder:"结束时间","value-format":"HH:mm",format:"HH:mm"},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}})],1),t._v(" "),i("div",{staticClass:"fields"},[i("span",{staticClass:"text"},[t._v("重复:")]),t._v(" "),i("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:t.weekdayValue,callback:function(e){t.weekdayValue=e},expression:"weekdayValue"}},t._l(t.weekdays,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),i("div",{staticClass:"fields"},[i("span",{staticClass:"text"},[t._v("名额限制: ")]),t._v(" "),i("el-input",{staticClass:"count-input",attrs:{placeholder:"不填写则默认为无限制",type:"number"},model:{value:t.limitValue,callback:function(e){t.limitValue=e},expression:"limitValue"}})],1)]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.settingDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.compeleteSetting}},[t._v("确 定")])],1)])],1)],1)},staticRenderFns:[]},q="拼命加载中",H="预约项目名称不能为空",W="请按要求填写规范的数据",z=[{value:"day",label:"天"},{value:"hour",label:"小时"},{value:"minute",label:"分钟"}],Z={components:{"cover-picker":R,"address-picker":M,"time-setter":i("VU/8")(G,F,!1,null,null,null).exports},data:function(){return{form:{image:"",name:"",description:"",address:"",latitude:0,longitude:0,check_mode:"auto",time_state:{normal:[{time:"09:00-10:00",limit:10,weekday:["Mon","Tues","Wed","Thur","Fri"]}],special:[]},multi_time:!1,date_display:7},reservationLimit:{reservation_limit:!1,reservation_per_user:1},aheadTime:{ahead_time:"",time_select:"day"},selectOptions:z,submitButtonDisabled:!1}},created:function(){var t=this;if(this.$route.params.id){var e=this.$loading({text:q,spinner:"el-icon-loading",customClass:"loading-style"});this.$http.get(this.GLOBAL.requestUrls.project+this.$route.params.id,this.getRequestConfig()).then(function(i){t.form=i.data,t.updateProps(t.form),t.updateForm(t.form),e.close()}).catch(function(i){e.close(),t.handleHttpError(i)})}},computed:{reservationLimitValid:function(){return"NaN"!==parseFloat(this.reservationLimit.reservation_per_user).toString()&&(!(this.reservationLimit.reservation_per_user<=0)&&this.reservationLimit.reservation_per_user%1==0)},displayDayValid:function(){return"NaN"!==parseFloat(this.form.date_display).toString()&&(!(this.form.date_display>7||this.form.date_display<1)&&this.form.date_display%1==0)},aheadTimeValid:function(){return""===this.aheadTime.ahead_time||"NaN"!==parseFloat(this.aheadTime.ahead_time).toString()&&(!(this.aheadTime.ahead_time<=0)&&this.aheadTime.ahead_time%1==0)}},methods:{updateProps:function(t){var e={};e.address=t.address,e.latitude=t.latitude,e.longitude=t.longitude,this.$refs.coverPickerRef.updateValue(t.image),this.$refs.addressPickerRef.updateValue(e),this.$refs.timeSetterRef.updateValue(t.time_state)},updateForm:function(t){t.reservation_per_user&&(this.reservationLimit.reservation_limit=!0,this.reservationLimit.reservation_per_user=t.reservation_per_user),this.aheadTime.time_select=V()(t.ahead_time)[0],this.aheadTime.ahead_time=j()(t.ahead_time)[0]?Number(j()(t.ahead_time)[0]):""},getComponentsData:function(){this.form.image=this.$refs.coverPickerRef.getData(),this.form.time_state=this.$refs.timeSetterRef.getData();var t=this.$refs.addressPickerRef.getData();this.form.address=t.address,this.form.latitude=t.latitude,this.form.longitude=t.longitude},getFormData:function(){var t=this;this.getComponentsData();var e=new FormData;return["name","description","address","latitude","longitude","check_mode","image","multi_time","date_display"].forEach(function(i){e.append(i,t.form[i])}),e.append("time_state",T()(this.form.time_state)),this.reservationLimit.reservation_limit&&e.append("reservation_per_user",this.reservationLimit.reservation_per_user),e.append("ahead_time",T()(this.getAheadTime())),e},getAheadTime:function(){var t={};return"day"===this.aheadTime.time_select?t.day=String(this.aheadTime.ahead_time):"hour"===this.aheadTime.time_select?t.hour=String(this.aheadTime.ahead_time):"minute"===this.aheadTime.time_select&&(t.minute=String(this.aheadTime.ahead_time)),t},submitForm:function(){var t=this,e=this.getFormData();this.form.name?this.reservationLimitValid&&this.aheadTimeValid&&this.displayDayValid?(this.submitButtonDisabled=!0,this.$route.params.id?this.$http.put(this.GLOBAL.requestUrls.project+this.$route.params.id,e,this.getRequestConfig()).then(function(e){t.setCookie("token",e.headers.authorization,t.GLOBAL.expire),t.submitButtonDisabled=!1,t.$router.push(t.GLOBAL.routers.projects),t.$message.success("修改"+t.form.name+"预约项目成功")}).catch(function(e){t.submitButtonDisabled=!1,t.handleHttpError(e)}):this.$http.post(this.GLOBAL.requestUrls.projects,e,this.getRequestConfig()).then(function(e){t.setCookie("token",e.headers.authorization,t.GLOBAL.expire),t.$router.push(t.GLOBAL.routers.projects),t.submitButtonDisabled=!1,t.$message.success("添加"+t.form.name+"预约项目成功")}).catch(function(e){t.submitButtonDisabled=!1,t.handleHttpError(e)})):this.$message.error(W):this.$message.error(H)}}},J={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form-com-container"},[i("div",{staticClass:"form-wrapper"},[i("div",{staticClass:"return-to-prev"},[i("router-link",{attrs:{to:"/admin/projects"}},[i("i",{staticClass:"el-icon-back"})]),t._v(" "),this.$route.params.id?i("span",[t._v("修改预约项目")]):i("span",[t._v("创建预约项目")])],1),t._v(" "),i("el-form",{ref:"form",attrs:{model:t.form}},[i("el-form-item",[i("cover-picker",{ref:"coverPickerRef",attrs:{image:t.form.image}})],1),t._v(" "),i("el-form-item",[i("div",{staticClass:"title-wrapper"},[i("el-input",{attrs:{placeholder:"请输入预约项目名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)]),t._v(" "),i("el-form-item",[i("div",{staticClass:"desc-wrapper"},[i("el-input",{attrs:{type:"textarea",rows:5,placeholder:"预约详情介绍或预约注意事项"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)]),t._v(" "),i("el-form-item",[i("address-picker",{ref:"addressPickerRef",attrs:{address:t.form.address,latitude:t.form.latitude,longitude:t.form.longitude}})],1),t._v(" "),i("el-form-item",[i("div",{staticClass:"form-check"},[i("span",{staticClass:"form-item-text"},[t._v("审核模式: ")]),t._v(" "),i("el-radio",{attrs:{label:"auto"},model:{value:t.form.check_mode,callback:function(e){t.$set(t.form,"check_mode",e)},expression:"form.check_mode"}},[t._v("自动审核")]),t._v(" "),i("el-radio",{attrs:{label:"manual"},model:{value:t.form.check_mode,callback:function(e){t.$set(t.form,"check_mode",e)},expression:"form.check_mode"}},[t._v("人工审核")])],1)]),t._v(" "),i("el-form-item",[i("div",{staticClass:"form-time-period-select"},[i("span",{staticClass:"form-item-text"},[t._v("预约时间设置:")]),t._v(" "),i("el-radio-group",{model:{value:t.form.multi_time,callback:function(e){t.$set(t.form,"multi_time",e)},expression:"form.multi_time"}},[i("el-radio",{attrs:{label:!1}},[t._v("预约单时段")]),t._v(" "),i("el-radio",{attrs:{label:!0}},[t._v("预约多时段")])],1)],1)]),t._v(" "),i("el-form-item",[i("time-setter",{ref:"timeSetterRef",attrs:{timeState:t.form.time_state}})],1),t._v(" "),i("el-form-item",[i("div",{staticClass:"form-reservation-limit"},[i("span",{staticClass:"form-item-text"},[t._v("单人预约上限")]),t._v(" "),i("div",{staticClass:"limit-control"},[i("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#909997"},model:{value:t.reservationLimit.reservation_limit,callback:function(e){t.$set(t.reservationLimit,"reservation_limit",e)},expression:"reservationLimit.reservation_limit"}}),t._v(" "),t.reservationLimit.reservation_limit?i("div",{staticClass:"limit-input"},[i("span",{staticClass:"form-item-text"},[t._v("每人可预约")]),t._v(" "),i("el-input",{model:{value:t.reservationLimit.reservation_per_user,callback:function(e){t.$set(t.reservationLimit,"reservation_per_user",e)},expression:"reservationLimit.reservation_per_user"}},[i("template",{slot:"append"},[t._v("次")])],2)],1):t._e()],1),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.reservationLimitValid,expression:"!reservationLimitValid"}],staticClass:"error-tip"},[t._v("请填写大于0的整数")])])]),t._v(" "),i("el-form-item",[i("div",{staticClass:"form-day-display"},[i("span",{staticClass:"form-item-text"},[i("span",[t._v("预约期限")]),t._v(" "),i("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("即用户可预约未来多少天内的项目，最大可设置为7天，1天内指的是当天，以此推算。")]),t._v(" "),i("i",{staticClass:"el-icon-info"})])],1),t._v(" "),i("el-input",{attrs:{placeholder:"请输入1-7之间的整数"},model:{value:t.form.date_display,callback:function(e){t.$set(t.form,"date_display",e)},expression:"form.date_display"}},[i("template",{slot:"append"},[t._v("天内")])],2),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.displayDayValid,expression:"!displayDayValid"}],staticClass:"error-tip"},[t._v("请填写1-7之间的整数")])],1)]),t._v(" "),i("el-form-item",[i("div",{staticClass:"form-ahead-time"},[i("span",{staticClass:"form-item-text"},[t._v("预约至少提前")]),t._v(" "),i("el-input",{staticClass:"ahead-time-input",attrs:{placeholder:"如不填写则默认可从当天开始预约"},model:{value:t.aheadTime.ahead_time,callback:function(e){t.$set(t.aheadTime,"ahead_time",e)},expression:"aheadTime.ahead_time"}},[i("template",{slot:"append"},[i("el-select",{staticClass:"ahead-time-select",model:{value:t.aheadTime.time_select,callback:function(e){t.$set(t.aheadTime,"time_select",e)},expression:"aheadTime.time_select"}},t._l(t.selectOptions,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],2),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.aheadTimeValid,expression:"!aheadTimeValid"}],staticClass:"error-tip"},[t._v("请填写大于0的整数或不填写")])],1)])],1),t._v(" "),i("div",{staticClass:"form-btn"},[i("el-button",[i("router-link",{attrs:{to:"/admin/projects"}},[t._v("取消")])],1),t._v(" "),i("el-button",{attrs:{type:"primary",disabled:t.submitButtonDisabled},on:{click:t.submitForm}},[t._v("确定")])],1)],1)])},staticRenderFns:[]},K=i("VU/8")(Z,J,!1,null,null,null).exports,Q={success:"已成功",wait:"待审核",cancelled:"已取消",checked:"已核销",overtime:"已过期"},X=[{value:"",label:"全部"},{value:"wait",label:Q.wait},{value:"success",label:Q.success},{value:"cancelled",label:Q.cancelled},{value:"checked",label:Q.checked},{value:"overtime",label:Q.overtime}],Y="取消预约",tt="核销预约",et="通过预约",it="拼命加载中",at={"已成功":Y,"待审核":Y},st={"已成功":tt,"待审核":et},rt={data:function(){return{reservations:[],totalReservations:0,projectState:"",reservationsDate:[],reservationsTel:"",reservationsState:"",reservationsStateOptions:X,processDialogVisible:!1,stateDialogVisible:!1,confirmButtonDisabled:!1,modalTitle:"",operateRemark:"",stateCountObj:{}}},computed:{formatedReservations:function(){return this.reservations.map(function(t){return Q[t.state]&&(t.state=Q[t.state]),t})}},created:function(){var t=this.$loading({text:it,spinner:"el-icon-loading",customClass:"loading-style"});this.getProjectState(t),this.getReservations(),this.getStateCount()},methods:{search:function(){this.filter(1)},filter:function(t){var e=this;this.$http({method:"get",url:this.GLOBAL.requestUrls.project+this.$route.params.id+"/reservations",headers:{Authorization:this.getCookie("token")},params:{tel:this.reservationsTel,date_to:this.reservationsDate.length?this.reservationsDate[1]:"",date_from:this.reservationsDate.length?this.reservationsDate[0]:"",state:this.reservationsState,page:t}}).then(function(t){e.reservations=t.data.reservations,e.totalReservations=t.data.count}).catch(function(t){e.handleHttpError(t)})},dismiss:function(t,e){this.reservationsIndex=t,this.modalTitle=at[e],this.processDialogVisible=!0},allow:function(t,e){this.reservationsIndex=t,this.modalTitle=st[e],this.processDialogVisible=!0},handleAllow:function(t,e){var i=this;this.processDialogVisible&&(this.confirmButtonDisabled=!0,this.$http({method:"post",url:this.GLOBAL.requestUrls.project+this.$route.params.id+"/reservations/"+this.reservations[this.reservationsIndex].id+t,headers:{Authorization:this.getCookie("token")}}).then(function(t){i.reservations[i.reservationsIndex].state=Q[e],i.getStateCount(),i.processDialogVisible=!1,i.confirmButtonDisabled=!1}).catch(function(t){i.confirmButtonDisabled=!1,i.handleHttpError(t)}))},handleDismiss:function(t,e){var i=this;this.processDialogVisible&&(this.confirmButtonDisabled=!0,this.$http({method:"post",url:this.GLOBAL.requestUrls.project+this.$route.params.id+"/reservations/"+this.reservations[this.reservationsIndex].id+t,headers:{Authorization:this.getCookie("token")},data:{remark:this.operateRemark}}).then(function(t){i.reservations[i.reservationsIndex].state=Q[e],i.reservations[i.reservationsIndex].remark=i.operateRemark,i.operateRemark="",i.getStateCount(),i.processDialogVisible=!1,i.confirmButtonDisabled=!1}).catch(function(t){i.confirmButtonDisabled=!1,i.handleHttpError(t)}))},confirm:function(){this.modalTitle===Y?this.handleDismiss("/cancel","cancelled"):this.modalTitle===tt?this.handleAllow("/check","checked"):this.modalTitle===et&&this.handleAllow("/pass","success")},handleCurrentChange:function(t){this.filter(t)},changeState:function(t){t?this.openProject():(this.projectState=!0,this.stateDialogVisible=!0)},closeProject:function(){var t=this;this.stateDialogVisible&&(this.confirmButtonDisabled=!0,this.$http.get(this.GLOBAL.requestUrls.project+this.$route.params.id+"/pause",this.getRequestConfig()).then(function(e){t.getReservations(),t.getStateCount(),t.projectState=!1,t.stateDialogVisible=!1,t.confirmButtonDisabled=!1}).catch(function(e){t.confirmButtonDisabled=!1,t.handleHttpError(e)}))},openProject:function(){var t=this;this.$http.get(this.GLOBAL.requestUrls.project+this.$route.params.id+"/open",this.getRequestConfig()).then(function(t){}).catch(function(e){t.handleHttpError(e)})},getStateCount:function(){var t=this;this.$http.get(this.GLOBAL.requestUrls.project+this.$route.params.id+"/reservations/count",this.getRequestConfig()).then(function(e){t.stateCountObj=e.data}).catch(function(e){t.handleHttpError(e)})},getReservations:function(){var t=this;this.$http.get(this.GLOBAL.requestUrls.project+this.$route.params.id+"/reservations",this.getRequestConfig()).then(function(e){t.reservations=e.data.reservations,t.totalReservations=e.data.count}).catch(function(e){t.handleHttpError(e)})},getProjectState:function(t){var e=this;this.$http.get(this.GLOBAL.requestUrls.project+this.$route.params.id,this.getRequestConfig()).then(function(i){"open"===i.data.state?e.projectState=!0:e.projectState=!1,t.close()}).catch(function(i){t.close(),e.handleHttpError(i)})}}},nt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"detail-com-container"},[i("div",{staticClass:"return-to-prev"},[i("router-link",{attrs:{to:"/admin/projects"}},[i("i",{staticClass:"el-icon-back"})]),t._v(" "),i("span",{staticClass:"reservation-name"},[t._v(t._s(this.$route.params.projectName)+"预约记录")]),t._v(" "),i("span",{staticClass:"project-state"},[t._v("开启预约")]),t._v(" "),i("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#909997"},on:{change:t.changeState},model:{value:t.projectState,callback:function(e){t.projectState=e},expression:"projectState"}}),t._v(" "),i("el-dialog",{attrs:{title:"确认关闭",visible:t.stateDialogVisible,width:"500px"},on:{"update:visible":function(e){t.stateDialogVisible=e}}},[i("span",[t._v("关闭项目后，该项目下的所有预约都会被自动取消，您确认要关闭么?")]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.stateDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary",disabled:t.confirmButtonDisabled},on:{click:t.closeProject}},[t._v("确 定")])],1)])],1),t._v(" "),i("div",{staticClass:"reservations-list"},[i("div",{staticClass:"reservations-search"},[i("el-date-picker",{staticClass:"date-picker",attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:t.reservationsDate,callback:function(e){t.reservationsDate=e},expression:"reservationsDate"}}),t._v(" "),i("div",{staticClass:"reservations-tel"},[i("span",[t._v("联系电话: ")]),t._v(" "),i("el-input",{staticClass:"tel-input",model:{value:t.reservationsTel,callback:function(e){t.reservationsTel=e},expression:"reservationsTel"}})],1),t._v(" "),i("div",{staticClass:"reservations-state"},[i("span",[t._v("预约状态: ")]),t._v(" "),i("el-select",{staticClass:"state-select",model:{value:t.reservationsState,callback:function(e){t.reservationsState=e},expression:"reservationsState"}},t._l(t.reservationsStateOptions,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),i("el-button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1),t._v(" "),i("div",{staticClass:"reservations-list-body"},[i("div",{staticClass:"list-wrapper"},[t._m(0),t._v(" "),t._l(t.formatedReservations,function(e,a){return i("div",{key:e.id,staticClass:"table-item"},[i("span",{staticClass:"item"},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"item"},[t._v(t._s(e.state))]),t._v(" "),i("span",{staticClass:"item"},[t._v(t._s(e.tel))]),t._v(" "),i("span",{staticClass:"item"},[t._v(t._s(e.date))]),t._v(" "),i("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},t._l(e.time,function(e){return i("span",[t._v(t._s(e)),i("br")])})),t._v(" "),i("span",{staticClass:"time item"},t._l(e.time,function(e){return i("span",{staticClass:"time-cell"},[t._v(t._s(e))])}))]),t._v(" "),i("span",{staticClass:"remark item"},[t._v(t._s(e.remark))]),t._v(" "),"已成功"===e.state?i("span",{staticClass:"operate item"},[i("span",{staticClass:"operate-set",on:{click:function(i){t.allow(a,e.state)}}},[t._v("核销")]),t._v(" "),i("span",{staticClass:"operate-set",on:{click:function(i){t.dismiss(a,e.state)}}},[t._v("取消")])]):"待审核"===e.state?i("span",{staticClass:"operate item"},[i("span",{staticClass:"operate-set",on:{click:function(i){t.allow(a,e.state)}}},[t._v("通过")]),t._v(" "),i("span",{staticClass:"operate-set",on:{click:function(i){t.dismiss(a,e.state)}}},[t._v("取消")])]):i("span",{staticClass:"operate item"},[t._v("---")])],1)})],2),t._v(" "),i("el-dialog",{ref:"modalRef",attrs:{title:t.modalTitle,visible:t.processDialogVisible,width:"500px"},on:{"update:visible":function(e){t.processDialogVisible=e}}},["取消预约"===t.modalTitle?i("el-input",{staticClass:"border-bottom",attrs:{placeholder:"请输入处理意见"},model:{value:t.operateRemark,callback:function(e){t.operateRemark=e},expression:"operateRemark"}}):"核销预约"===t.modalTitle?i("span",[t._v("是否核销该预约?")]):i("span",[t._v("是否通过该预约?")]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.processDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary",disabled:t.confirmButtonDisabled},on:{click:t.confirm}},[t._v("确 定")])],1)],1),t._v(" "),i("div",{staticClass:"reservations-list-bottom"},[i("div",{staticClass:"state-count"},[i("span",[t._v("总计: "+t._s(t.stateCountObj.total))]),t._v(" "),i("span",[t._v("待审核: "+t._s(t.stateCountObj.wait))]),t._v(" "),i("span",[t._v("已成功: "+t._s(t.stateCountObj.success))]),t._v(" "),i("span",[t._v("已核销: "+t._s(t.stateCountObj.checked))]),t._v(" "),i("span",[t._v("已拒绝: "+t._s(t.stateCountObj.refused))]),t._v(" "),i("span",[t._v("已取消: "+t._s(t.stateCountObj.cancelled))]),t._v(" "),i("span",[t._v("已过期: "+t._s(t.stateCountObj.overtime))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.reservations.length,expression:"reservations.length"}],staticClass:"pagination-wrapper"},[i("el-pagination",{attrs:{"page-size":10,layout:"prev, pager, next, jumper",total:t.totalReservations},on:{"current-change":t.handleCurrentChange}})],1)])],1)])])},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table-item table-head"},[i("span",{staticClass:"item"},[t._v("姓名")]),t._v(" "),i("span",{staticClass:"item"},[t._v("预约状态")]),t._v(" "),i("span",{staticClass:"item"},[t._v("联系电话")]),t._v(" "),i("span",{staticClass:"item"},[t._v("预约时间")]),t._v(" "),i("span",{staticClass:"time item"},[t._v("预约时间段")]),t._v(" "),i("span",{staticClass:"remark item"},[t._v("备注")]),t._v(" "),i("span",{staticClass:"operate item"},[t._v("操作")])])}]},ot=i("VU/8")(rt,nt,!1,null,null,null).exports;a.default.use(l.a);var lt=new l.a({routes:[{path:"/",components:{nav:y,content:w}},{path:"/login",components:{nav:"",content:h}},{path:"/admin/projects",components:{nav:y,content:w}},{path:"/admin/projects/new",components:{nav:y,content:K}},{path:"/admin/projects/edit/:id",components:{nav:y,content:K}},{path:"/admin/projects/reservation/:id/:projectName",components:{nav:y,content:ot}}],mode:"hash"}),ct=i("mtWM"),dt=i.n(ct),ut=i("Rf8U"),mt=i.n(ut),pt=(i("U7mS"),i("rdV6"),"https://concierge.skylarkly.com"),ht={server:pt,expire:1296e5,routers:{login:"/login",projects:"/admin/projects",projects_new:"/admin/projects/new",projects_edit:"/admin/projects/edit/",reservations_details:"/admin/projects/reservation/"},requestUrls:{code:pt+"/code",login:pt+"/login",projects:pt+"/projects",project:pt+"/projects/",covers:pt+"/covers",image:pt+"/image"},httpStateInfo:{invalid_token:"Invalid Token"}},vt=i("VU/8")(ht,null,!1,null,null,null).exports;function ft(t){var e,i=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(i))?e[2]:null}function _t(t){var e=new Date;e.setTime(e.getTime()-1);var i=ft(t);null!=i&&(document.cookie=t+"="+i+";expires="+e.toGMTString())}a.default.config.productionTip=!1,a.default.use(r.a),a.default.use(mt.a,dt.a),a.default.prototype.setCookie=function(t,e,i){var a=new Date;a.setTime(a.getTime()+i),document.cookie=t+"="+e+(null==i?"":";expires="+a.toGMTString())},a.default.prototype.getCookie=ft,a.default.prototype.delCookie=_t,a.default.prototype.handleHttpError=function(t){401===t.response.status&&(t.response.data===vt.httpStateInfo.invalid_token?(_t("token"),lt.push(vt.routers.login),r.a.Message.error("登录已过期，请重新登录。")):lt.push(vt.routers.projects))},a.default.prototype.getRequestConfig=function(){return{headers:{Authorization:ft("token")}}},a.default.prototype.GLOBAL=vt,new a.default({el:"#app",router:lt,components:{App:o},template:"<App/>",created:function(){this.checkLogin()},watch:{$route:function(t,e){this.checkLogin()}},methods:{checkLogin:function(){this.getCookie("token")?this.$route.path==this.GLOBAL.routers.login?this.$router.push(this.GLOBAL.routers.projects):this.$router.push(this.$route.path):this.$router.push(this.GLOBAL.routers.login)}}})},rdV6:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.909fa61ada412fac649b.js.map